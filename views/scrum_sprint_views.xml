<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <record id="view_scrum_sprint_kanban" model="ir.ui.view">
    <field name="name">scrum.sprint.kanban</field>
    <field name="model">scrum.sprint</field>
    <field name="type">kanban</field>
    <field name="arch" type="xml">
      <kanban>
        <!-- 1) Declare the One2many here so Owl will fetch it -->
        <field name="story_ids"/>
        <templates>
          <t t-name="kanban-box">
            <div class="oe_kanban_card">
              <div class="oe_kanban_header">
                <strong><field name="name"/></strong>
              </div>
              <div class="oe_kanban_body">
                <!-- Now story_ids is defined -->
                <span class="badge badge-secondary">
                  Stories: <t t-esc="record.story_ids.value.length"/>
                </span>
              </div>
              <div class="oe_kanban_footer">
                Stato: <t t-esc="record.state.value"/>
              </div>
            </div>
          </t>
        </templates>
      </kanban>
    </field>
  </record>
</odoo>
